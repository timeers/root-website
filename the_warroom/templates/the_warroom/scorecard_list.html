{% extends 'the_keep/base.html' %}
{% block title %} - Scorecards{% endblock %}
{% block content %}





{% if unassigned_scorecards %}
<h1>Unassigned Scorecards ({{ unassigned_count }})</h1>
These scorecards have not been linked with a game:


<table>
    <thead>
        <tr>
            <th>Faction</th>
            <th>Points</th>
            <th>Turns</th>
            <th>Note</th>
            <th>Actions</th> <!-- Added an Actions column for the buttons -->
            <th>Info</th>
        </tr>
    </thead>
    <tbody class="scorecard-rows">
        {% for object in unassigned_scorecards %}
        <tr>
            <td>
                <a href="{% url 'faction-detail' object.faction.slug %}">{{  object.faction }}</a>
            </td>
            <td>
                {{ object.total_points }}
            </td>
            <td>
                {{ object.turns.count }}
            </td>

            <td>
                {% if object.description %}
                    {% if object.description|length > 30 %}
                        {{ object.description|slice:":30" }}...
                    {% else %}
                        {{ object.description }}
                    {% endif %}
                {% else %}
                    None
                {% endif %}
            </td>
            <td>
                <a class="btn btn-danger btn-sm ml-1 ms-1 mb-1" href="{% url 'delete-scorecard' object.id %}">
                    <i class="bi bi-trash3"></i>
                </a>
                <a class="btn btn-warning btn-sm ml-1 ms-1 mb-1" href="{% url 'update-scorecard' object.id %}">
                    <i class="bi bi-pencil-square"></i>
                </a>
             
                {% if object.efforts_available %}
                    <a class="btn btn-success btn-sm ml-1 ms-1 mb-1" href="{% url 'assign-effort' object.id %}">
                        <i class="bi bi-link"></i>
                    </a>
                {% endif %}
            </td>
            <td>
                <!-- Button to toggle the visibility of the hidden row -->
                <button class="btn btn-info btn-sm ml-1 ms-1 mb-1" type="button" data-bs-toggle="collapse" data-bs-target="#collapse-{{ object.id }}" aria-expanded="false" aria-controls="collapse-{{ object.id }}">
                    <i class="bi bi-info-circle"></i>
                </button>
            </td>
        </tr>
        <!-- Hidden row that will be shown when the button is clicked -->
        <tr id="collapse-{{ object.id }}" class="collapse">
            <td colspan="5"> <!-- Make sure the hidden row spans across all columns -->
                <div class="card card-body">
                    <!-- Hidden content -->
                    {% include 'the_warroom/partials/scorecard.html' %}
                </div>
            </td>
        </tr>

        {% endfor %}

        {% if unassigned_count > 10 %}
        <tr>
            <td colspan="6">
                + Assign or Delete Unassigned Scorecards for more
            </td>
        </tr>
        {% endif %}
    </tbody>
</table>

{% endif %}


<div style="display: flex; justify-content: space-between; align-items: center;">
    <h1>{% if complete_scorecards %}Your {% endif %}Scorecards</h1>
    {% if user.profile.tester %}
        <a class="btn btn-success ml-1 ms-1 mb-1" href="{% url 'record-scorecard' %}">New Scorecard +</a>
    {% endif %}
</div>


{% if complete_scorecards %}
<table>
    <thead>
        <tr>
            <th>Faction</th>
            <th>Points</th>
            <th>Turns</th>

            <th>Player</th>
            <th>Actions</th> <!-- Added an Actions column for the buttons -->
            <th>Info</th>
        </tr>
    </thead>
    <tbody class="scorecard-rows">


        {% include 'the_warroom/partials/scorecard_list_partial.html' %}

</tbody>
</table>
{% else %}
    You have not recorded any scorecards
{% endif %}







{% endblock content %}