{% extends 'the_keep/base.html' %}
{% load static i18n %}
{% block title %}{% trans 'Games' %} | {% endblock %}

{% block meta %}    <!-- Open Graph tags -->
<meta property="og:type" content="website">
<meta property="og:url" content="{{ request.build_absolute_uri }}">
<meta property="og:image" content="{% static 'images/battlefield-icon.png' %}">
<meta property="og:site_name" content="Root Database">
<meta property="og:title" content="{{ player.name }}'s Games">
<meta property="og:description" content="{{ player.name }}'s Recorded Games on the Root Database">
<meta name="description" content="{{ player.name }}'s Recorded Games on the Root Database">
{% endblock meta%}

{% block content %}
{% include 'the_warroom/partials/warroom_nav_header.html' with active_page='my-games' %}

<article class="content-section mt-2">
<div class="d-flex justify-content-between align-items-center">
    <div class='d-flex align-items-center gap-2'>
        <a href="{% url 'player-detail' player.slug %}">
            {% if user.profile != player %}
            {{ player.name }}'s
            {% endif %}
            {% trans 'Profile' %}
        </a>
        <i class="bi bi-chevron-right"></i>
        <span>{% trans 'Games' %}</span>
    </div>
</div>
</article>

<div class="d-flex content-section">
    <div class="article-img-container">
        <img class="article-img" src="{{ player.image.url }}">
    </div>
        <div>
            <div class='d-flex flex-nowrap'>

                <h1 class="account-heading root-title">{{ player.name }}'s {% trans 'Games' %}</h1>

            </div>

            
        </div>

</div>


{% url 'player-games' player.slug as filter_url %}
{% include 'the_warroom/partials/universal_game_filter.html' with form=form filter_url=filter_url show_single_faction=True player_name=player.name %}
    
        {% include 'the_warroom/partials/game_list_home.html' %}
    
    

    
{% endblock content %} 


{% block scripts %}
    <script>
        // Universal select2 initialization - handles both singular and plural field names
        const selectPlaceholders = {
            '#id_faction': "{% trans 'Select a Faction' %}",
            '#id_factions': "{% trans 'Select Factions' %}",
            '#id_player': "{% trans 'Select Players' %}",
            '#id_players': "{% trans 'Select Players' %}",
            '#id_vagabond': "{% trans 'Select Vagabonds' %}",
            '#id_vagabonds': "{% trans 'Select Vagabonds' %}",
            '#id_map': "{% trans 'Select a Map' %}",
            '#id_deck': "{% trans 'Select a Deck' %}"
        };

        // Apply select2 only to fields that exist on the page
        Object.keys(selectPlaceholders).forEach(id => {
            if ($(id).length) {
                $(id).select2({
                    placeholder: selectPlaceholders[id],
                    allowClear: true,
                    width: '100%'
                });
            }
        });

        if ($('#id_official').length) {
            $('#id_official').select2({
                width: '100%'
            });
        }
    </script>
{% endblock %}