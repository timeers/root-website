{% extends 'the_keep/base.html' %}
{% load static %}
{% block title %} - {{ expansion.title }}{% endblock %}

{% block meta %}    <!-- Open Graph tags -->
<meta property="og:type" content="website">
<meta property="og:url" content="{{ request.build_absolute_uri }}">
<meta property="og:image" content="{% if expansion.picture %}{{ expansion.picture.url }}{% else %}{% static 'images/RDB_Logo.png' %}{% endif %}">
<meta property="og:site_name" content="Root Database">
<meta property="og:title" content="{{ expansion.title }}">
<meta property="og:description" content="{{ expansion.title }}{% if expansion.designer %} by {{ expansion.designer.name }} {% endif %}{% if expansion.lore %} - {{ expansion.lore }}{% elif expansion.description %} - {{expansion.description}}{% endif %}">
<meta name="description" content="{{ expansion.title }}{% if expansion.designer %} by {{ expansion.designer.name }} {% endif %}{% if expansion.lore %} - {{ expansion.lore }}{% elif expansion.description %} - {{expansion.description}}{% endif %}">
{% endblock meta%}

{% block content %}
<div style="display: flex; justify-content: space-between; align-items: center;">
        <h1>{{ expansion.title }}</h1>
        {% if expansion.designer == user.profile and user.profile.designer %}
                <div>
                    <a class="btn btn-warning btn-sm mt-1 mb-1" href="{% url 'expansion-update' expansion.slug %}"><i class="bi bi-pencil-square"></i></a>
                    <a class="btn btn-danger btn-sm mt-1 mb-1" href="{% url 'expansion-delete' expansion.slug %}"><i class="bi bi-trash3"></i></a>
                </div>
        {% endif %}
</div>
        {% if expansion.designer %}
            by 
                {% if user.profile.player %}
                        <a class="mr-2" href="{% url 'player-detail' expansion.designer.slug %}">{{ expansion.designer.name }}</a>
                {% else %}
                        {{ expansion.designer.name }}
                {% endif %}
        {% endif %}
        {% if expansion.picture %}
        <div><img class="rounded-corner-img responsive-img mb-1" src="{{ expansion.picture.url }}"></div>
        {% endif %}
        {% if expansion.lore %}
            <p class="lore-content mt-2">{{ expansion.lore }}</p>
        {% endif %}
        {% if expansion.description %}
        <div>{{ expansion.description }}</div>
        {% endif %}
        
        {% if open_expansion %}
                <div>
                        Open Until {{ expansion.end_date|date:"F j, Y" }}
                </div>
        {% endif %}

        {% if links_count != 0 %}
            {% include 'the_keep/partials/links.html' %}
        {% endif %}


        {% if expansion.get_posts %}
            {% if expansion.get_factions %}
            <h2>Factions</h2>
            {% for object in expansion.get_factions %}
                
                    {% include 'the_keep/partials/post.html' %}
                
            {% endfor %}
            {% endif %}
            {% if expansion.get_decks %}
            <h2>Decks</h2>
            {% for object in expansion.get_decks %}
                
                    {% include 'the_keep/partials/post.html' %}
                
            {% endfor %}
            {% endif %}
            {% if expansion.get_maps %}
            <h2>Maps</h2>
            {% for object in expansion.get_maps %}
                
                    {% include 'the_keep/partials/post.html' %}
                
            {% endfor %}
            {% endif %}
            {% if expansion.get_vagabonds %}
            <h2>Vagabonds</h2>
            {% for object in expansion.get_vagabonds %}
                
                    {% include 'the_keep/partials/post.html' %}
                
            {% endfor %}
            {% endif %}
            {% if expansion.get_hirelings %}
            <h2>Hirelings</h2>
            {% for object in expansion.get_hirelings %}
                
                    {% include 'the_keep/partials/post.html' %}
                
            {% endfor %}
            {% endif %}
            {% if expansion.get_landmarks %}
            <h2>Landmarks</h2>
            {% for object in expansion.get_landmarks %}
                
                    {% include 'the_keep/partials/post.html' %}
                
            {% endfor %}
            {% endif %}
            {% if expansion.get_clockwork %}
            <h2>Clockwork Factions</h2>
            {% for object in expansion.get_clockwork %}
                
                    {% include 'the_keep/partials/post.html' %}
                
            {% endfor %}
            {% endif %}
        {% else %}
                <div>
                Looks like nothing has been added to this expansion yet. Please check back later.
                </div>
        {% endif %}
    
{% endblock content %} 