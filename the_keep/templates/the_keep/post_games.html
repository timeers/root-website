{% extends 'the_keep/base.html' %}
{% load i18n %}
{% block title %}{{ object.title }} Games | {% endblock %}

{% block meta %}
    {% include 'the_keep/partials/component_meta.html' %}
{% endblock meta %}

{% block content %}

<h1 class='root-title'>{{ object.title }} {% trans 'Games' %}</h1>

{% if games %}

    {% include 'the_warroom/partials/universal_game_filter.html' with form=form filter_url=object.get_games_url swap_method='innerHTML' %}

    <div id="games-container">


        {% include 'the_keep/partials/game_list.html' %}

    </div>

{% endif %}

    <!-- Show option to send Feedback -->
    <div class='mb-2'>
        <a href="{% url 'post-feedback' object.slug %}" class='subtle-link'>
            <small>
                {% trans 'Is something missing or incorrect?' %}
            </small>
        </a>
     </div>

{% endblock content %} 

{% block scripts %}
    <script>
        // Universal select2 initialization - handles both singular and plural field names
        const selectPlaceholders = {
            '#id_faction': "{% trans 'Select Factions' %}",
            '#id_factions': "{% trans 'Select Factions' %}",
            '#id_player': "{% trans 'Select Players' %}",
            '#id_players': "{% trans 'Select Players' %}",
            '#id_vagabond': "{% trans 'Select Vagabonds' %}",
            '#id_vagabonds': "{% trans 'Select Vagabonds' %}",
            '#id_map': "{% trans 'Select a Map' %}",
            '#id_deck': "{% trans 'Select a Deck' %}"
        };

        // Apply select2 only to fields that exist on the page
        Object.keys(selectPlaceholders).forEach(id => {
            if ($(id).length) {
                $(id).select2({
                    placeholder: selectPlaceholders[id],
                    allowClear: true,
                    width: '100%'
                });
            }
        });

        if ($('#id_official').length) {
            $('#id_official').select2({
                width: '100%'
            });
        }
    </script>
{% endblock %}