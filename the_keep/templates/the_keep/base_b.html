{% extends 'the_keep/template.html' %}

{% block template %}
    <main role="main" id="main-content">
        
        <div style="position: relative;">
            {% if background_image %}
                <div class='background-image-padding' style="{{ background_image.style }}"></div>
            {% endif %}


            {% if messages or global_message or user_notifications %}
            <div class="floating-alert">

                {% if global_message %}
                    <div class="alert alert-{{ global_message_type }} alert-dismissible fade show" role="alert">
                        {{ global_message }}
                        <button type="button" class="close" data-bs-dismiss="alert" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                {% endif %}

                {% for message in messages %}
                <div class="alert alert-{% if message.tags == 'error' %}danger{% else %}{{ message.tags }}{% endif %} alert-dismissible fade show" role="alert">
                    {{ message }}
                    <button type="button" class="close" data-bs-dismiss="alert" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                {% endfor %}

                {% if user_notifications %}
                    {% for notification in user_notifications %}
                    <div class="alert alert-{{ notification.message_type }} alert-dismissible fade show" role="alert">
                        {{ notification.message }}
                        {% if notification.related_url %}
                            <a href="{{ notification.related_url }}" class="alert-link ms-2" onclick="dismissNotification({{ notification.id }}, '{% url 'dismiss-notification' notification.id %}')">View</a>
                        {% endif %}
                        <button type="button" class="close" data-bs-dismiss="alert" aria-label="Close" onclick="dismissNotification({{ notification.id }}, '{% url 'dismiss-notification' notification.id %}')">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    {% endfor %}
                {% endif %}
            </div>
            {% endif %}

          
            {% block content %}{% endblock %}
        </div>

    </main>
    {% endblock %}